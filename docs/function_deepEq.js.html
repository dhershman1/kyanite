<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>function/deepEq.js - Documentation</title>
    
    <meta name="description" content="A small library of pure functional utilities to make life easier and data better" />
    
        <meta name="keywords" content="functional, library, javascript, pure, helpers, utils" />
        <meta name="keyword" content="functional, library, javascript, pure, helpers, utils" />
    
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/dhershman1/kyanite" target="_blank" class="menu-item" id="repository" >Github repo</a></h2><ul class="nav-list"><h3>Number</h3><li class="nav-item" data-cat="Number"><a href="functions.html#add">add</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#between">between</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#clamp">clamp</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#dec">dec</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#divide">divide</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#factors">factors</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#gcd">gcd</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#inc">inc</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#isEven">isEven</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#isOdd">isOdd</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#isPrime">isPrime</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#isZero">isZero</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#lcm">lcm</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#mean">mean</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#median">median</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#mod">mod</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#multiply">multiply</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#negate">negate</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#pow">pow</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#product">product</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#range">range</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#rem">rem</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#round">round</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#subtract">subtract</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#sum">sum</a></li><li class="nav-item" data-cat="Number"><a href="functions.html#within">within</a></li><h3>Function</h3><li class="nav-item" data-cat="Function"><a href="functions.html#addIndex">addIndex</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#always">always</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#and">and</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#ap">ap</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#apply">apply</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#ascend">ascend</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#ascendBy">ascendBy</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#both">both</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#branch">branch</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#complement">complement</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#compose">compose</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#composeP">composeP</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#count">count</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#curry">curry</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#curryN">curryN</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#deepEq">deepEq</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#defaultTo">defaultTo</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#descend">descend</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#descendBy">descendBy</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#either">either</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#encase">encase</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#eq">eq</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#eqBy">eqBy</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#flip">flip</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#gt">gt</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#gte">gte</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#has">has</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#identity">identity</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#isEmpty">isEmpty</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#isNil">isNil</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#lt">lt</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#lte">lte</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#memoizeWith">memoizeWith</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#not">not</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#notEq">notEq</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#on">on</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#or">or</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#pipe">pipe</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#pipeP">pipeP</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#reduce">reduce</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#reduced">reduced</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#reject">reject</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#size">size</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#type">type</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#unless">unless</a></li><li class="nav-item" data-cat="Function"><a href="functions.html#when">when</a></li><h3>Object</h3><li class="nav-item" data-cat="Object"><a href="functions.html#amend">amend</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#any">any</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#draft">draft</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#height">height</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#omit">omit</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#over">over</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#path">path</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#pathOr">pathOr</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#plan">plan</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#prop">prop</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#propEq">propEq</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#propOr">propOr</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#props">props</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#sift">sift</a></li><li class="nav-item" data-cat="Object"><a href="functions.html#whole">whole</a></li><h3>String</h3><li class="nav-item" data-cat="String"><a href="functions.html#capitalize">capitalize</a></li><li class="nav-item" data-cat="String"><a href="functions.html#fuzzySearch">fuzzySearch</a></li><li class="nav-item" data-cat="String"><a href="functions.html#match">match</a></li><li class="nav-item" data-cat="String"><a href="functions.html#replace">replace</a></li><li class="nav-item" data-cat="String"><a href="functions.html#split">split</a></li><li class="nav-item" data-cat="String"><a href="functions.html#test">test</a></li><li class="nav-item" data-cat="String"><a href="functions.html#toLower">toLower</a></li><li class="nav-item" data-cat="String"><a href="functions.html#toUpper">toUpper</a></li><li class="nav-item" data-cat="String"><a href="functions.html#trim">trim</a></li><h3>Array</h3><li class="nav-item" data-cat="Array"><a href="functions.html#chunk">chunk</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#concatMap">concatMap</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#countBy">countBy</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#difference">difference</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#drop">drop</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#dropWhile">dropWhile</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#ensureArray">ensureArray</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#every">every</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#everyPass">everyPass</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#filter">filter</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#find">find</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#findIndex">findIndex</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#fold">fold</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#groupBy">groupBy</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#insert">insert</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#intersection">intersection</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#join">join</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#juxt">juxt</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#length">length</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#map">map</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#max">max</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#maxBy">maxBy</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#min">min</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#minBy">minBy</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#partition">partition</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#prepend">prepend</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#reduceRight">reduceRight</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#remove">remove</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#some">some</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#somePass">somePass</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#sort">sort</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#sortBy">sortBy</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#sortWith">sortWith</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#take">take</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#takeWhile">takeWhile</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#union">union</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#uniq">uniq</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#uniqBy">uniqBy</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#update">update</a></li><li class="nav-item" data-cat="Array"><a href="functions.html#zip">zip</a></li><h3>List</h3><li class="nav-item" data-cat="List"><a href="functions.html#concat">concat</a></li><li class="nav-item" data-cat="List"><a href="functions.html#endsWith">endsWith</a></li><li class="nav-item" data-cat="List"><a href="functions.html#first">first</a></li><li class="nav-item" data-cat="List"><a href="functions.html#includes">includes</a></li><li class="nav-item" data-cat="List"><a href="functions.html#last">last</a></li><li class="nav-item" data-cat="List"><a href="functions.html#nth">nth</a></li><li class="nav-item" data-cat="List"><a href="functions.html#reverse">reverse</a></li><li class="nav-item" data-cat="List"><a href="functions.html#slice">slice</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">function/deepEq.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import _curry2 from '../_internals/_curry2'
import eq from './eq'
import type from './type'

const _functionName = f => {
  const match = String(f).match(/^function (\w*)/)

  return match == null ? '' : match[1]
}

const _containsWith = (pred, x, list) => {
  for (let i = 0, len = list.length; i &lt; len; i++) {
    if (pred(x, list[i])) {
      return true
    }
  }

  return false
}

const _arrFromIter = iter => {
  const list = []
  let next = null

  while (!(next = iter.next()).done) {
    list.push(next.value)
  }

  return list
}

const _uniqContentEquals = (aIterator, bIterator, stackA, stackB) => {
  var a = _arrFromIter(aIterator)
  var b = _arrFromIter(bIterator)

  function _eq (_a, _b) {
    return deepEq(_a, _b, stackA.slice(), stackB.slice())
  }

  // if *a* array contains any element that is not included in *b*
  return !_containsWith(function (b, aItem) {
    return !_containsWith(_eq, aItem, b)
  }, b, a)
}

/**
 * @name deepEq
 * @function
 * @since v0.1.0
 * @category Function
 * @sig a -> b -> Boolean
 * @description Takes and compares two items. Capable of handling cyclical data structures
 * @param {Any} a First item to compare
 * @param {Any} b Second item to compare
 * @return {Boolean} Returns the boolean after running our comparison check
 *
 * @example
 * import { deepEq } from 'kyanite'
 *
 * const q = { a: 1 }
 *
 * deepEq({ a: 1 }, { a: 1 }) // => true
 * deepEq({ a: 1, b: 2 }, { b: 2, a: 1 }) // => true
 * deepEq(/[A-Z]/, new RegExp('[A-Z]') // => true
 * deepEq([1, 2], [1, 2]) // => true
 * deepEq(new Date(), new Date()) // => true
 * deepEq({ a: { q } }, { a: { q } }) // => true
 *
 * deepEq('test', new String('test')) // => false
 * deepEq(false, new Boolean(false)) // => false
 * deepEq(5, new Number(5)) // => false
 * deepEq([1, 2], [2, 1]) // => false
 * deepEq({ a: 1 }, { b: 1 }) // => false
 * deepEq(new Date('11/14/1992'), new Date('11/14/2018')) // => false
 * deepEq([], {}) // => false
 */
const deepEq = (a, b, stackA = [], stackB = []) => {
  if (eq(a, b)) {
    return true
  }

  const aType = type(a)

  if (aType !== type(b) || a == null || b == null) {
    return false
  }

  if (typeof a.equals === 'function' || typeof b.equals === 'function') {
    return typeof a.equals === 'function' &amp;&amp; a.equals(b) &amp;&amp;
      typeof b.equals === 'function' &amp;&amp; b.equals(a)
  }

  // Using the types certain logic should be called and addressed
  switch (aType) {
    case 'Arguments':
    case 'Array':
    case 'Object':
      if (typeof a.constructor === 'function' &amp;&amp;
        _functionName(a.constructor) === 'Promise') {
        return a === b
      }
      break
    case 'Boolean':
    case 'Number':
    case 'String':
      if (!(typeof a === typeof b &amp;&amp; eq(a.valueOf(), b.valueOf()))) {
        return false
      }
      break
    case 'Date':
      if (!eq(a.valueOf(), b.valueOf())) {
        return false
      }
      break
    case 'Error':
      return a.name === b.name &amp;&amp; a.message === b.message
    case 'RegExp':
      if (!(a.source === b.source &amp;&amp;
        a.global === b.global &amp;&amp;
        a.ignoreCase === b.ignoreCase &amp;&amp;
        a.multiline === b.multiline &amp;&amp;
        a.sticky === b.sticky &amp;&amp;
        a.unicode === b.unicode)) {
        return false
      }
      break
  }

  for (let i = stackA.length - 1; i >= 0; i--) {
    if (stackA[i] === a) {
      return stackB[i] === b
    }
  }

  switch (aType) {
    case 'Map':
      if (a.size !== b.size) {
        return false
      }

      return _uniqContentEquals(a.entries(), b.entries(), stackA.concat([a]), stackB.concat([b]))
    case 'Set':
      if (a.size !== b.size) {
        return false
      }

      return _uniqContentEquals(a.values(), b.values(), stackA.concat([a]), stackB.concat([b]))
    case 'Arguments':
    case 'Array':
    case 'Object':
    case 'Boolean':
    case 'Number':
    case 'String':
    case 'Date':
    case 'Error':
    case 'RegExp':
    case 'Int8Array':
    case 'Uint8Array':
    case 'Uint8ClampedArray':
    case 'Int16Array':
    case 'Uint16Array':
    case 'Int32Array':
    case 'Uint32Array':
    case 'Float32Array':
    case 'Float64Array':
    case 'ArrayBuffer':
      break
    default:
      return false
  }

  const keysA = Object.keys(a)

  if (keysA.length !== Object.values(b).length) {
    return false
  }

  const extendedStackA = stackA.concat([a])
  const extendedStackB = stackB.concat([b])

  for (let i = keysA.length - 1; i >= 0; i--) {
    const key = keysA[i]

    if (!(Object.prototype.hasOwnProperty.call(b, key) &amp;&amp; deepEq(b[key], a[key], extendedStackA, extendedStackB))) {
      return false
    }
  }

  return true
}

export default _curry2(deepEq)
</code></pre>
        </article>
    </section>





    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.2</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js"></script>


</body>
</html>
